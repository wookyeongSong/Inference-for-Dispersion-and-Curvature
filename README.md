# Inference-for-Dispersion-and-Curvature


### General Information

This repository contains the implementation for the paper **"Inference for Dispersion and Curvature of Random Objects"** which were run using R 4.3.1. It provides two one-click *wrapper* R scripts that reproduce every table and figure in the main manuscript and the supplement.

### Wrapper R scripts

It contains two wrapper R scripts:
*	`DC_wrapper_main.R`: Executes all analyses presented in the main paper and reproduces all the Tables 1-2 and corresponding Figures 2-7, which are saved as PDF files.
*	`DC_wrapper_supplement.R`: Executes all additional simulations and real data analyses in the Supplement of the paper and reproduces the Table S.1 and the corresponding Figures S.1-S.10, which are saved as PDF files.

For running the wrapper R scripts, 
1. Clone or download the repository and set your R working directory to the project root.
2. In an R console: source("DC_wrapper_main.R")
- or from a terminal: Rscript DC_wrapper_main.R
  
## Supplementary results
source("DC_wrapper_supplement.R")

the working directory needs to be set to the directory where you saved this repository. It can be run `source("DC_wrapper_main.R")` in R console or `Rscript DC_wrapper_main.R` in terminal.

In `src` Folder: 
* `/DC_mainfunctions.R`: Contains all main functions necessary for the simulations and real data analysis.

In `Figures_code` Folder: This folder contains R scripts that reproduce all figures in the main manuscript and supplementary materials.
* `Figure2.R`-`Figure7.R`: Generate Figure 2 through Figure 7 in main manuscript. The figures are automatically saved as PDF files.
* `FigureS1.R`-`FigureS10.R`: Generate Figure S.1 through Figure S.10 in the Supplement. The figures are automatically saved as PDF files.

### Libraries and dependencies used by the code

R package to run simulations, real data analysis and to reproduce figures:

* igraph version 1.5.0
* ellipse version 0.4.5
* CovTools version 0.5.4
* spherepc version 0.1.7
* abind version 1.4-5
* fdapace version 0.5.9
* colorspace version 2.1-0
* plotrix version 3.8-2
* expm version 0.999-7
* vegan version 2.6-4
* readxl version 1.4.3
* fdadensity version 0.1.2
* ggplot2 version 3.5.0
* fields version 14.1
* scatterplot3d version 0.3-44
* expm version 0.999-7

All packages are available through CRAN (https://cran.r-project.org/) and can be installed automatically by running install.packages(PACKAGE_NAME) in an R session.

### Folder Structure

project/
├─ src/                   # functions only
│   └─ DC_mainfunctions.R
├─ scripts/               # one analysis step per script
│   ├─ 01_generate_data.R
│   ├─ 02_distance_matrices.R
│   ├─ 03_curvature_test.R
│   └─ 04_visualisations.R
├─ results/               # auto-generated by the pipeline
├─ run_pipeline.R         # new wrapper
└─ README.md



* `./src/`  code for all functions used in the paper.
* `./simulations/`  code to reproduce simulations in Section 5 and Supplment Section S.1.
* `./Applications/` code to reproduce data analysis in Section 6 and Supplment Section S.2.
