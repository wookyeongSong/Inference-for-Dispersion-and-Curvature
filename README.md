# Inference-for-Dispersion-and-Curvature


## General Information

This repository contains the implementation for the paper **"Inference for Dispersion and Curvature of Random Objects"** which were run using R 4.3.1. It provides two one-click *wrapper* R scripts that reproduce every table and figure in the main manuscript and the supplement.

## Wrapper R scripts

It contains two wrapper R scripts:
*	`DC_wrapper_main.R`: Executes all analyses presented in the main paper and reproduces all the Tables 1-2 and corresponding Figures 2-7, which are saved as PDF files.
*	`DC_wrapper_supplement.R`: Executes all additional simulations and real data analyses in the Supplement of the paper and reproduces the Table S.1 and the corresponding Figures S.1-S.10, which are saved as PDF files.

For running the wrapper R scripts, 
1. Clone or download the repository and set your R working directory to the project root.
2. In an R console: `source("DC_wrapper_main.R")` or in a terminal: `Rscript DC_wrapper_main.R`

## Details on reproducing results, figures, and tables 

In `simulations` folder:
* `/DC_sphere_contam.R`: Running this R code will produce results corresponding to Figure 2 in Section 4.2.
* `/DC_distribution.R`: Running this R code will produce results corresponding to Figure 3, 4 in Section 5.1.
* `/DC_pointcloud.R`: Running this R code will produce results corresponding to Table 1 and Figure 5 in Section 5.2.
* `/DC_spd.R`: Running this R code will produce results corresponding to Figure S.1 in Section S.1.1.
* `/DC_sphere.R`: Running this R code will produce results corresponding to Figure S.2 in Section S.1.2.
* `/DC_power_analysis.R`: Running this R code will produce results corresponding to Figure S.3 in Section S.1.3.
* `/DC_highdim.R`: Running this R code will produce results corresponding to Figure S.4 in Section S.1.4.

In `Applications` folder:
* `DC_gait.R`: Before running this script, set the file path to the gait synchronization data, available at [Truong et al. 2019, 'A data set for the study of human locomotion with inertial measurements units', Image Processing On Line 9, 381–390."][https://github.com/deepcharles/gait-data]. Running this R code will produce results corresponding to Table 2 and Figure 6 in Section 6.1. 


In `Figures_code` folder: This folder contains R scripts that reproduce each figure in the main manuscript and supplement.
* `/Figure2.R`-`/Figure7.R`: Generate Figure 2 through Figure 7 in main manuscript. The figures are automatically saved as PDF files.
* `/FigureS1.R`-`/FigureS10.R`: Generate Figure S.1 through Figure S.10 in the Supplement. The figures are automatically saved as PDF files.

In `Figures` folder: Contains all Figures in the main manuscript and supplement as png or pdf files.

In `src` folder: 
* `/DC_mainfunctions.R`: Contains all main functions necessary for the simulations and real data analysis.


### Libraries and dependencies used by the code

R package to run simulations, real data analysis and to reproduce figures:

* igraph version 1.5.0
* ellipse version 0.4.5
* CovTools version 0.5.4
* spherepc version 0.1.7
* abind version 1.4-5
* fdapace version 0.5.9
* colorspace version 2.1-0
* plotrix version 3.8-2
* expm version 0.999-7
* vegan version 2.6-4
* readxl version 1.4.3
* fdadensity version 0.1.2
* ggplot2 version 3.5.0
* fields version 14.1
* scatterplot3d version 0.3-44
* expm version 0.999-7

All packages are available through CRAN (https://cran.r-project.org/) and can be installed automatically by running install.packages(PACKAGE_NAME) in an R session.

### Folder Structure

project/
├─ src/                   # functions only
│   └─ DC_mainfunctions.R
├─ scripts/               # one analysis step per script
│   ├─ 01_generate_data.R
│   ├─ 02_distance_matrices.R
│   ├─ 03_curvature_test.R
│   └─ 04_visualisations.R
├─ results/               # auto-generated by the pipeline
├─ run_pipeline.R         # new wrapper
└─ README.md



* `./src/`  code for all functions used in the paper.
* `./simulations/`  code to reproduce simulations in Section 5 and Supplment Section S.1.
* `./Applications/` code to reproduce data analysis in Section 6 and Supplment Section S.2.
